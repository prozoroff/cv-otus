–ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ ¬´–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–∞–Ω–¥—à–∞—Ñ—Ç–∞ –ó–µ–º–ª–∏ –ø–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º —Å–Ω–∏–º–∫–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–æ–¥–æ–≤ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è¬ª

- üß≤ [train_unet.ipynb](https://github.com/prozoroff/cv-otus/blob/main/project/train_unet.ipynb): –±–ª–æ–∫–Ω–æ—Ç —Å –∫–æ–¥–æ–º –æ–±—É—á–µ–Ω–∏—è unet-–º–æ–¥–µ–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ª–∞–Ω–¥—à–∞—Ñ—Ç–∞
- ‚¨ÜÔ∏è [train_srgan.ipynb](https://github.com/prozoroff/cv-otus/blob/main/project/train_srgan.ipynb): –±–ª–æ–∫–Ω–æ—Ç —Å –∫–æ–¥–æ–º –æ–±—É—á–µ–Ω–∏—è srgan-–º–æ–¥–µ–ª–∏ –ø–æ–≤—ã—à–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤
- üìä [match_histogram.ipynb](https://github.com/prozoroff/cv-otus/blob/main/project/match_histogram.ipynb)
: –±–ª–æ–∫–Ω–æ—Ç —Å –∫–æ–¥–æ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤ –∑–∞ —Ä–∞–∑–Ω—ã–µ –≥–æ–¥—ã
- ‚ö° [inference.ipynb](https://github.com/prozoroff/cv-otus/blob/main/project/inference.ipynb)
: –±–ª–æ–∫–Ω–æ—Ç —Å –ø—Ä–∏–º–µ—Ä–æ–º –∑–∞–ø—É—Å–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

## –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç—ã –≤ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏

- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–∞–Ω–¥—à–∞—Ñ—Ç–∞ –ø–æ –¥–∞–Ω–Ω—ã–º –æ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å–µ–ª–µ–Ω–∏—è: [arxiv paper](https://arxiv.org/pdf/2101.05069)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤ –ø–æ –∫–ª–∞—Å—Å—É –º–µ—Å—Ç–Ω–æ—Å—Ç–∏: [github code](https://github.com/weihancug/GAN-based-HRRS-Sample-Generation-for-Image-Classification)
- –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–¥–µ–ª–æ–∫ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é GAN: [arxiv paper](https://arxiv.org/pdf/1802.04881)
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π Landsat 8 –≤ Sentinel-2 —Å –ø–æ–º–æ—â—å—é GAN: [github code](https://github.com/Rohit18/Landsat8-Sentinel2-Fusion)
- –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤ –ø–æ –¥–∞–Ω–Ω—ã–º —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é SD: [github code](https://github.com/RubenGres/Seg2Sat)
- –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤: [github code](https://github.com/fisch92/Metric-embeddings-for-satellite-image-classification)
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è –≤–æ–∑–¥—É—Ö–∞ –ø–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º —Å–Ω–∏–º–∫–∞–º: [github code](https://github.com/arnavbansal1/SatellitePollutionCNN)
- Super resolution –¥–ª—è —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤: [ieee paper](https://ieeexplore.ieee.org/document/9472869)
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ª–µ—Å–Ω–æ–º –ø–æ–∫—Ä—ã—Ç–∏–∏: [github code](https://github.com/annusgit/ForestCoverChange)
- –î–µ—Ç–µ–∫—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–µ–∂–¥—É –¥–≤—É–º—è —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º–∏ —Å–Ω–∏–º–∫–∞–º–∏ [ipol paper](https://www.ipol.im/pub/art/2022/439/article.pdf)

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

- –≤—ã–≥—Ä—É–∂–∞–µ–º –∏—Ö Google Earth –ø–æ–ø–∞—Ä–Ω—ã–µ –ø–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω—ã–µ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ —Å–Ω–∏–º–∫–∏ –∑–∞ 2007 –∏ 2014 –≥–æ–¥
- –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –Ω–∞—Ä–µ–∑–∞–µ–º –∏—Ö –Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç—ã 128 –Ω–∞ 128 (~5k –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –æ–¥–Ω–æ–≥–æ –ø–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ)

<br/><div align="center" >
  <img alt="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö" src="./assets/dataset.png" width="700px" />
</div><br/>

### –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º

–£ —Å–Ω–∏–º–∫–æ–≤ –∑–∞ —Ä–∞–∑–Ω—ã–µ –≥–æ–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å:
- —Ä–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- —Ä–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- —Ä–∞–∑–Ω—ã–µ –ø–æ–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å–Ω–∏–º–∫–∏, —Å–¥–µ–ª–∞–Ω–Ω—ã–µ –≤ –æ–¥–∏–Ω –º–µ—Å—è—Ü –º–æ–≥—É—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø–æ-—Ä–∞–∑–Ω–æ–º—É. –°–∞–º–æ–µ –º–∞–ª–æ–µ, —á—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å - –≤—ã—Ä–æ–≤–Ω—è—Ç—å –∫—Ä–∏–≤—ã–µ –ø–æ–∫–∞–Ω–∞–ª—å–Ω–æ, —á—Ç–æ–±—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–º–µ–ª–∏ –±–ª–∏–∑–∫–∏–µ —Ü–≤–µ—Ç–∞, –∫–æ–Ω—Ç—Ä–∞—Å—Ç –∏ —è—Ä–∫–æ—Å—Ç—å.

```python
image2_equalized = np.zeros_like(image2)

for i in range(3):  # –ü—Ä–æ—Ö–æ–¥ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–∞–Ω–∞–ª—É RGB
    hist1 = cv2.calcHist([image1], [i], None, [256], [0, 256])
    hist2 = cv2.calcHist([image2], [i], None, [256], [0, 256])

    cdf1 = hist1.cumsum()
    cdf1 = (cdf1 / cdf1[-1]) * 255

    cdf2 = hist2.cumsum()
    cdf2 = (cdf2 / cdf2[-1]) * 255

    lut = np.interp(cdf2, cdf1, range(256)).astype(np.uint8)
    image2_equalized[:,:,i] = cv2.LUT(image2[:,:,i], lut)
```

<br/><div align="center" >
  <img alt="–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º" src="./assets/histogram_matching.png" width="500px" />
</div><br/>

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –ø–∞—Ä

–î–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ:
- –∏–º–µ—é—Ç —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ –¥–µ—Ç–∞–ª–µ–π
- –∏–º–µ—é—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–µ—Ç–∞–ª–µ–π
- –æ—Ç–ª–∏—á–∞—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ

–î–ª—è –ø–æ–∏—Å–∫–∞ –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö –ø—Ä–æ–±–ª–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å—É–º–º—ã –∫—Ä–∞–µ–≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –ö—ç–Ω–Ω–∏.

```python
factor = 1 / (PATSH_SIZE * PATSH_SIZE)
canny_sum = kornia.filters.canny(img.unsqueeze(0).float(), kernel_size=CANNY_KERNEL_SIZE)[0].sum() * factor
```

–ü—Ä–∏–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å–æ —Å–ª–∏—à–∫–æ–º –º–∞–ª—ã–º –∏ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–µ—Ç–∞–ª–µ–π:

<br/><div align="center" >
  <img alt="–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π" src="./assets/low_canny.png" width="700px" />
  <img alt="–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π" src="./assets/high_canny.png" width="700px" />
</div><br/>

–î–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ –ø—É–Ω–∫—Ç–∞ –ø–æ—Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏–∫—Å–µ–ª–µ–π –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö, –æ—Ç–ª–∏—á–∞—é—â–∏—Ö—Å—è –±–æ–ª—å—à–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã –∏, –æ–ø—è—Ç—å –∂–µ, –æ—Ç—Å–µ—á–µ–º –ø–æ –ø–æ—Ä–æ–≥—É.

```python
factor = 1 / (CHANNELS * PATSH_SIZE * PATSH_SIZE)
diff_sum = (torch.abs(img_1 - img_2) > DIFF_THRESHOLD).sum().item() * factor
```

–ü—Ä–∏–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–ª–∏—á–∏–π –≤—ã—à–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞:

<br/><div align="center" >
  <img alt="–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π" src="./assets/large_diff.png" width="700px" />
</div><br/>

## UNet-–º–æ–¥–µ–ª—å

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–ù–∞—Ä–µ–∑–∞–µ–º —Ç—Ä–µ—Ö–∫–∞–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 128 –Ω–∞ 128 –Ω–∞ –ø–∞—Ç—á–∏ —Ä–∞–∑–º–µ—Ä–æ–º 32 –Ω–∞ 32. –ü–æ–ª—É—á–∞–µ–º –≤—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º 48x32x32:

<br/><div align="center" >
  <img alt="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö" src="./assets/patches.png" width="500px" />
</div><br/>
